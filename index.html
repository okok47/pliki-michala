<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<title>EPSTEIN cie GONI</title>

<style>
html, body {
    margin: 0;
    padding: 0;
    width: 100%;
    height: 100%;
    overflow: hidden;
    background: black;
    font-family: Arial, sans-serif;
}

#player {
    position: absolute;
    width: 40px;
    height: 40px;
    background: white;
    border-radius: 50%;
    z-index: 10;
}

video {
    position: absolute;
    width: 200px;
    pointer-events: none;
}

#hud {
    position: fixed;
    top: 10px;
    left: 10px;
    color: white;
    font-size: 20px;
    z-index: 20;
}

#gameover {
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.8);
    color: white;
    display: none;
    align-items: center;
    justify-content: center;
    flex-direction: column;
    font-size: 40px;
    z-index: 50;
}
</style>
</head>

<body>

<div id="hud">Czas: <span id="time">0.0</span>s</div>

<div id="player"></div>

<audio id="music" src="muzyka.mp3" loop></audio>

<video src="film1.mp4" autoplay loop muted playsinline></video>
<video src="film2.mp4" autoplay loop muted playsinline></video>
<video src="film3.mp4" autoplay loop muted playsinline></video>
<video src="film4.mp4" autoplay loop muted playsinline></video>

<div id="gameover">
    <div>GAME OVER</div>
    <div style="font-size:20px;margin-top:10px">Odśwież stronę, aby zagrać ponownie</div>
</div>

<script>
const player = document.getElementById("player");
const videos = [...document.querySelectorAll("video")];
const music = document.getElementById("music");
const timeEl = document.getElementById("time");
const gameover = document.getElementById("gameover");

let keys = {};
let alive = true;
let startTime = null;

let px = window.innerWidth / 2;
let py = window.innerHeight / 2;
const pSpeed = 4;

const size = 200;
let enemySpeed = 0.6;

const enemies = videos.map(v => ({
    v,
    x: Math.random() * (window.innerWidth - size),
    y: Math.random() * (window.innerHeight - size)
}));

document.addEventListener("keydown", e => keys[e.key.toLowerCase()] = true);
document.addEventListener("keyup", e => keys[e.key.toLowerCase()] = false);

// start muzyki po kliknięciu
document.addEventListener("click", () => {
    music.volume = 1;
    music.play();
}, { once: true });

function distance(ax, ay, bx, by) {
    return Math.hypot(ax - bx, ay - by);
}

function loop(timestamp) {
    if (!alive) return;

    if (!startTime) startTime = timestamp;
    const t = (timestamp - startTime) / 1000;
    timeEl.textContent = t.toFixed(1);

    // przyspieszanie wrogów
    enemySpeed = 0.6 + t * 0.05;

    // ruch gracza
    if (keys["w"] || keys["arrowup"]) py -= pSpeed;
    if (keys["s"] || keys["arrowdown"]) py += pSpeed;
    if (keys["a"] || keys["arrowleft"]) px -= pSpeed;
    if (keys["d"] || keys["arrowright"]) px += pSpeed;

    px = Math.max(0, Math.min(window.innerWidth - 40, px));
    py = Math.max(0, Math.min(window.innerHeight - 40, py));

    player.style.left = px + "px";
    player.style.top = py + "px";

    // wrogowie gonią gracza
    enemies.forEach(e => {
        let dx = px - e.x;
        let dy = py - e.y;
        let len = Math.hypot(dx, dy);
        dx /= len;
        dy /= len;

        e.x += dx * enemySpeed;
        e.y += dy * enemySpeed;

        e.v.style.left = e.x + "px";
        e.v.style.top = e.y + "px";

        // kolizja
        if (distance(px + 20, py + 20, e.x + size/2, e.y + size/2) < size/2) {
            alive = false;
            gameover.style.display = "flex";
            music.pause();
        }
    });

    requestAnimationFrame(loop);
}

requestAnimationFrame(loop);
</script>

</body>
</html>

